# Project cronjobs
# 1. Entry: Minute when the process will be started [0-60]
# 2. Entry: Hour when the process will be started [0-23]
# 3. Entry: Day of the month when the process will be started [1-28/29/30/31]
# 4. Entry: Month of the year when the process will be started [1-12]
# 5. Entry: Weekday when the process will be started [0-6] (0 is Sunday) or [mon, tue, wed, thu, fri, or sat, sun]

{% if sites is not defined %}
# Clear old sessions once every day
0 7 * * *     {{ user_name }}         cd {{ project_root }} && . env/bin/activate && python src/manage.py clearsessions --settings={{ project_src_dir }}.conf.{{ target }} >> log/clear_sessions.log 2>&1
# Delete inactive users after X days of inactivity once every day
0 3 * * *     {{ user_name }}         cd {{ project_root }} && . env/bin/activate && python src/manage.py deleteinactiveusers --settings={{ project_src_dir }}.conf.{{ target }} >> log/delete_inactive_users.log 2>&1
# Send emails about new messages to the users every 15 minutes
*/15 * * * *     {{ user_name }}         cd {{ project_root }} && . env/bin/activate && python src/manage.py notify_about_messages --settings={{ project_src_dir }}.conf.{{ target }} >> log/notify_about_messages.log 2>&1
{% endif %}

{% if sites is defined %}
# In the case of multi-site setup:

{% for item in sites %}

# Clear old sessions once every day
0 7 * * *     {{ user_name }}         cd {{ project_root }} && . env/bin/activate && python src/manage.py clearsessions --settings={{ project_src_dir }}.conf.{{ target }}_{{ item.name }} >> log/clear_sessions-{{item.name}}.log 2>&1
# Delete inactive users after X days of inactivity once every day
0 3 * * *     {{ user_name }}         cd {{ project_root }} && . env/bin/activate && python src/manage.py deleteinactiveusers --settings={{ project_src_dir }}.conf.{{ target }}_{{ item.name }} >> log/delete_inactive_users-{{item.name}}.log 2>&1
# Send emails about new messages to the users every 15 minutes
*/15 * * * *     {{ user_name }}         cd {{ project_root }} && . env/bin/activate && python src/manage.py notify_about_messages --settings={{ project_src_dir }}.conf.{{ target }} >> log/notify_about_messages.log 2>&1

{% endfor %}
{% endif %}

# Ensure this file ends with a newline!
